<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>QR Codes</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="{{ url_for('static', filename='home.css') }}">
  </head>
  <body class="terminal">
    <div id="content">
      <section id="nav-container">
        <div id="title-container">
          <h1 id="nav-title">QR Code Generator</h1>
        </div>
      </section>
      <div id="grid-container">
        <section id="empty-container" class="column">
        </section>
        <section id="form-container" class="column">
          <form id="qrcode-form" method="POST" action="/">
            <fieldset>
              {{ form.csrf_token }}

              <div class="data-fields">
                <div class="fields">
                  {{ form.qrcode_data.label }} <br>
                  <hr>
                  {{ form.qrcode_data(class="inputs") }}
                </div>

                <div class="fields">
                  {{ form.qrcode_gif_url.label }} <br>
                  <hr>
                  {{ form.qrcode_gif_url(class="inputs") }}
                </div>
              </div>

              <div class="style-fields">
                <div class="color-fields">
                  <div class="fields">
                    {{ form.qrcode_color.label }} <br>
                    <hr>
                    {{ form.qrcode_color(class="inputs color-picker") }}
                  </div>

                  <div class="fields">
                    {{ form.qrcode_color_acc.label }} <br>
                    <hr>
                    {{ form.qrcode_color_acc(class="inputs color-picker") }}
                  </div>
                </div>

                <div class="background-fields">
                  <div class="fields">
                    {{ form.qrcode_bg_color.label }} <br>
                    <hr>
                    {{ form.qrcode_bg_color(class="inputs color-picker") }}
                  </div>

                  <div class="fields">
                    {{ form.qrcode_bg_color_acc.label }} <br>
                    <hr>
                    {{ form.qrcode_bg_color_acc(class="inputs color-picker") }}
                  </div>
                </div>

                <div class="size-fields">
                  <div class="fields">
                    {{ form.qrcode_border_size.label }} <br>
                    <hr>
                    {{ form.qrcode_border_size(class="inputs") }}
                  </div>

                  <div class="fields">
                    {{ form.qrcode_scale.label }} <br>
                    <hr>
                    {{ form.qrcode_scale(class="inputs") }}
                  </div>
                </div>
              </div>

              <div class="submit-btn">
                <button id="submit" class="nes-btn is-primary" type="submit" form="qrcode-form">Generate QR Code</button>
              </div>
            </fieldset>
          </form>
        </section>
        <section id="qrcode-container" class="column">
          <div id="qrcode">
            <img id="picture" src="data:image/png;base64,{{ qrcode_img_data }}">
          </div>
          <div id="color">

          </div>
        </section>
      </div>
      <!-- <section id="footer-container">
        <div id="footer">
          <div id="github">
            <a href="https://github.com/" target="_blank" rel="noopener noreferrer"><img src="static/GitHub_Logo_White.png" alt="Girl in a jacket"></a>
          </div>
        </div>
      </section> -->
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script> 
    <script>
      // document.getElementById('qrcode_data').addEventListener('input', function(e) {
      //   console.log("Print Hello World");
      // });

      $(document).ready(function() {
        $.ajaxSetup({
          headers: {
            "X-CSRFToken": "{{ csrf_token() }}"
          }
        });

        $('.inputs').on('input', function(e) {
          $.ajax({
            type: 'POST',
            url: '/',
            data: {
              'qrcode_data': $('#qrcode_data').val(),
              'gif_url': $('#qrcode_gif_url').val(),
              'color': $('#qrcode_color').val(),
              'color_acc': $('#qrcode_color_acc').val(),
              'bg_color': $('#qrcode_bg_color').val(),
              'bg_color_acc': $('#qrcode_bg_color_acc').val(),
              'border_size': $('#qrcode_border_size').val(),
              'scale': $('#qrcode_scale').val(),
            },
            success: function(response) {
              $("#picture").attr("src", `data:image/png;base64,${response}`);
            }
          });
        });
      });
    </script>
  </body>
</html>